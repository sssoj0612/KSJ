<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>내 위치</title>
</head>
<body>
<div id="map" style="width:100%;height:350px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=0984e3595a25d0814186af721b2fb03f&libraries=services"></script>
<script>
    var map;
    var infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });

    function initMap() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function (pos) {
                var get_latitude = pos.coords.latitude;
                var get_longitude = pos.coords.longitude;

                var mapOption = {
                    center: new kakao.maps.LatLng(get_latitude, get_longitude),
                    level: 3
                };
                map = new kakao.maps.Map(document.getElementById('map'), mapOption);

                ps.keywordSearch('반려동물장례식장', placesSearchCB);
            }, function (error) {
                console.error(error);
            });
        }
    }

    function placesSearchCB(data, status, pagination) {
        if (status === kakao.maps.services.Status.OK) {
            var bounds = new kakao.maps.LatLngBounds();

            for (var i = 0; i < data.length; i++) {
                displayMarker(data[i]);
                bounds.extend(new kakao.maps.LatLng(data[i].y, data[i].x));
            }

            map.setBounds(bounds);
        }
    }

    function displayMarker(place) { // 마커 표시 함수
        var marker = new kakao.maps.Marker({
            map: map,
            position: new kakao.maps.LatLng(place.y, place.x)
        });

        kakao.maps.event.addListener(marker, 'click', function () { // 마커 클릭이벤트
            // 마커를 클릭하면 장소명이 인포윈도우에 표출
            infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>');
            infowindow.open(map, marker);
        });
    }

    // 지도 초기화 함수 호출
    initMap();
</script>
</body>
</html>