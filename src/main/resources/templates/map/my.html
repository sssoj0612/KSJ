<!-- /*
* Template Name: Tour
* Template Author: Untree.co
* Tempalte URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Untree.co">
    <link rel="shortcut icon" href="/images/favicon.png">

    <meta name="description" content="" />
    <meta name="keywords" content="bootstrap, bootstrap4" />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Source+Serif+Pro:wght@400;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/owl.carousel.min.css">
    <link rel="stylesheet" href="/css/owl.theme.default.min.css">
    <link rel="stylesheet" href="/css/jquery.fancybox.min.css">
    <link rel="stylesheet" href="/fonts/icomoon/style.css">
    <link rel="stylesheet" href="/fonts/flaticon/font/flaticon.css">
    <link rel="stylesheet" href="/css/daterangepicker.css">
    <link rel="stylesheet" href="/css/aos.css">
    <link rel="stylesheet" href="/css/style.css">

    <title>사용자 위치</title>
</head>

<body>


<div class="site-mobile-menu site-navbar-target">
    <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close">
            <span class="icofont-close js-menu-toggle"></span>
        </div>
    </div>
    <div class="site-mobile-menu-body"></div>
</div>

<nav class="site-nav">
    <div class="container">
        <div class="site-navigation">
            <a href="/index" class="logo m-0">KSJ <span class="text-primary">.</span></a>

            <ul class="js-clone-nav d-none d-lg-inline-block text-left site-menu float-right">
                <li class="active"><a href="/index">Home</a></li>
                <li class="has-children">
                    <a href="#">Dropdown</a>
                    <ul class="dropdown">
                        <li><a href="/services">Services</a></li>
                        <li><a href="/about">About</a></li>
                        <li class="has-children">
                            <a href="#">Menu Two</a>
                            <ul class="dropdown">
                                <li><a href="#">Sub Menu One</a></li>
                                <li><a href="#">Sub Menu Two</a></li>
                                <li><a href="#">Sub Menu Three</a></li>
                            </ul>
                        </li>
                        <li><a href="#">Menu Three</a></li>
                    </ul>
                </li>
                <li><a href="/contact">Contact Us</a></li>
                <li><a href="/notice">Notice</a></li>
                <li th:if="${session.SS_USER_ID == null}"> <!-- 로그인 X일 때 -->
                    <a href="/user/login_resist_form">Login/Join</a>
                </li>
                <li th:if="${session.SS_USER_ID != null}">
                    <a href="javascript:void(0);" onclick="logout()">Logout</a>
                </li>
                <li th:if="${session.SS_USER_ID != null}"> <!-- 로그인 O일 때-->
                    <strong> 환영합니다, [[${session.SS_USER_ID}]]님.</strong>
                </li>
            </ul>

            <a href="#" class="burger ml-auto float-right site-menu-toggle js-menu-toggle d-inline-block d-lg-none light" data-toggle="collapse" data-target="#main-navbar">
                <span></span>
            </a>

        </div>
    </div>
</nav>


<div class="hero hero-inner">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-6 mx-auto text-center">
                <div class="intro-wrap">
                    <h1 class="mb-0">Elements</h1>
                    <p class="text-white">Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. </p>
                </div>
            </div>
        </div>
    </div>
</div>



<div class="untree_co-section">
    <div class="container my-5">
        <div class="mb-5">
            <p style="margin-top:-12px">
                <b>Chrome 브라우저는 https 환경에서만 geolocation을 지원합니다.</b> 참고해주세요.
            </p>
            <div id="map" style="width:100%;height:350px;"></div> <!--지도-->
            지도를 확대/축소 하세요<br><br>
            <div id="info"></div> <!--사용자 위치에서 가장 가까운 장소 정보-->
        </div>
    </div>

    <div class="row justify-content-center">

        <div class="col-lg-4">
            <div class="custom-block" data-aos="fade-up">
                <h2 class="section-title">Accordion</h2>
                <div class="custom-accordion" id="accordion_1">
                    <div class="accordion-item">
                        <h2 class="mb-0">
                            <button class="btn btn-link" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">How to download and register?</button>
                        </h2>

                        <div id="collapseOne" class="collapse show" aria-labelledby="headingOne" data-parent="#accordion_1">
                            <div class="accordion-body">
                                Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.
                            </div>
                        </div>
                    </div> <!-- .accordion-item -->

                    <div class="accordion-item">
                        <h2 class="mb-0">
                            <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">How to create your paypal account?</button>
                        </h2>
                        <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordion_1">
                            <div class="accordion-body">
                                A small river named Duden flows by their place and supplies it with the necessary regelialia. It is a paradisematic country, in which roasted parts of sentences fly into your mouth.
                            </div>
                        </div>
                    </div> <!-- .accordion-item -->
                    <div class="accordion-item">
                        <h2 class="mb-0">
                            <button class="btn btn-link collapsed" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">How to link your paypal and bank account?</button>
                        </h2>

                        <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-parent="#accordion_1">
                            <div class="accordion-body">
                                When she reached the first hills of the Italic Mountains, she had a last view back on the skyline of her hometown Bookmarksgrove, the headline of Alphabet Village and the subline of her own road, the Line Lane. Pityful a rethoric question ran over her cheek, then she continued her way.
                            </div>
                        </div>

                    </div> <!-- .accordion-item -->

                </div>
            </div> <!-- END .custom-block -->
            <div class="custom-block" data-aos="fade-up">
                <h2 class="section-title">Gallery</h2>
                <div class="row gutter-v2 gallery">
                    <div class="col-4">
                        <a href="/images/gal_1.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_1.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                    <div class="col-4">
                        <a href="/images/gal_2.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_2.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                    <div class="col-4">
                        <a href="/images/gal_3.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_3.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                    <div class="col-4">
                        <a href="/images/gal_4.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_4.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                    <div class="col-4">
                        <a href="/images/gal_5.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_5.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                    <div class="col-4">
                        <a href="/images/gal_6.jpg" class="gal-item" data-fancybox="gal"><img src="/images/gal_6.jpg" alt="Image" class="img-fluid"></a>
                    </div>
                </div>
            </div> <!-- END .custom-block -->

            <div class="custom-block" data-aos="fade-up">
                <h2 class="section-title">Video</h2>

                <a href="https://vimeo.com/342333493" data-fancybox class="video-wrap">
                    <span class="play-wrap"><span class="icon-play"></span></span>
                    <img src="/images/bg_1.jpg" alt="Image" class="img-fluid rounded">
                </a>
            </div> <!-- END .custom-block -->
        </div>
        <div class="col-lg-4">
            <div class="custom-block" data-aos="fade-up" data-aos-delay="100">
                <h2 class="section-title">Form</h2>
                <form class="contact-form bg-white">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="text-black" for="fname">First name</label>
                                <input type="text" class="form-control" id="fname">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="text-black" for="lname">Last name</label>
                                <input type="text" class="form-control" id="lname">
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="text-black" for="email">Email address</label>
                        <input type="email" class="form-control" id="email" aria-describedby="emailHelp">
                        <small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
                    </div>
                    <div class="form-group">
                        <label class="text-black" for="password">Password</label>
                        <input type="password" class="form-control" id="password">
                    </div>
                    <div class="form-group">
                        <label class="text-black" for="message">Message</label>
                        <textarea name="" class="form-control" id="message" cols="30" rows="5"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="text-black" for="select">Select</label>

                        <select name="" id="select" class="custom-select">
                            <option value="">Untree.co</option>
                            <option value="">Offers high quality free template</option>
                        </select>

                    </div>
                    <div class="form-group">
                        <label class="control control--checkbox">
                            <span class="caption">Custom checkbox</span>
                            <input type="checkbox" checked="checked" />
                            <div class="control__indicator"></div>
                        </label>
                    </div>
                    <button type="submit" class="btn btn-primary">Submit</button>
                </form>
            </div>

            <div class="custom-block" data-aos="fade-up">
                <h2 class="section-title">Social Icons</h2>
                <ul class="list-unstyled social-icons light">
                    <li><a href="#"><span class="icon-facebook"></span></a></li>
                    <li><a href="#"><span class="icon-twitter"></span></a></li>
                    <li><a href="#"><span class="icon-linkedin"></span></a></li>
                    <li><a href="#"><span class="icon-google"></span></a></li>
                    <li><a href="#"><span class="icon-play"></span></a></li>
                </ul>
            </div> <!-- END .custom-block -->

            <div class="custom-block" data-aos="fade-up" data-aos-delay="100">
                <div class="text-center">
                    <h2 class="section-title text-center">Slider</h2>
                </div>
                <div class="owl-single owl-carousel no-nav">
                    <div class="testimonial mx-auto">
                        <figure class="img-wrap">
                            <img src="/images/person_2.jpg" alt="Image" class="img-fluid">
                        </figure>
                        <h3 class="name">Adam Aderson</h3>
                        <blockquote>
                            <p>&ldquo;There live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.&rdquo;</p>
                        </blockquote>
                    </div>

                    <div class="testimonial mx-auto">
                        <figure class="img-wrap">
                            <img src="/images/person_3.jpg" alt="Image" class="img-fluid">
                        </figure>
                        <h3 class="name">Lukas Devlin</h3>
                        <blockquote>
                            <p>&ldquo;There live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.&rdquo;</p>
                        </blockquote>
                    </div>

                    <div class="testimonial mx-auto">
                        <figure class="img-wrap">
                            <img src="/images/person_4.jpg" alt="Image" class="img-fluid">
                        </figure>
                        <h3 class="name">Kayla Bryant</h3>
                        <blockquote>
                            <p>&ldquo;There live the blind texts. Separated they live in Bookmarksgrove right at the coast of the Semantics, a large language ocean.&rdquo;</p>
                        </blockquote>
                    </div>

                </div>
            </div>

        </div>
    </div>

    <div class="row justify-content-center mt-5 section">

        <div class="col-lg-10">
            <div class="row mb-5">
                <div class="col text-center">
                    <h2 class="section-title text-center">Our Team</h2>
                </div>
            </div>
            <div class="row">
                <div class="col-lg-3 mb-4">
                    <div class="team">
                        <img src="/images/person_1.jpg" alt="Image" class="img-fluid mb-4">
                        <div class="px-3">
                            <h3 class="mb-0">James Watson</h3>
                            <p>Co-Founder &amp; CEO</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 mb-4">
                    <div class="team">
                        <img src="/images/person_2.jpg" alt="Image" class="img-fluid mb-4">
                        <div class="px-3">
                            <h3 class="mb-0">Carl Anderson</h3>
                            <p>Co-Founder &amp; CEO</p>
                        </div>
                    </div>
                </div>

                <div class="col-lg-3 mb-4">
                    <div class="team">
                        <img src="/images/person_4.jpg" alt="Image" class="img-fluid mb-4">
                        <div class="px-3">
                            <h3 class="mb-0">Michelle Allison</h3>
                            <p>Co-Founder &amp; CEO</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-3 mb-4">
                    <div class="team">
                        <img src="/images/person_3.jpg" alt="Image" class="img-fluid mb-4">
                        <div class="px-3">
                            <h3 class="mb-0">Drew Wood</h3>
                            <p>Co-Founder &amp; CEO</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

</div>
</div>

<div class="py-5 cta-section">
    <div class="container">
        <div class="row text-center">
            <div class="col-md-12">
                <h2 class="mb-2 text-white">Lets you Explore the Best. Contact Us Now</h2>
                <p class="mb-4 lead text-white text-white-opacity">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Excepturi, fugit?</p>
                <p class="mb-0"><a href="booking.html" class="btn btn-outline-white text-white btn-md font-weight-bold">Get in touch</a></p>
            </div>
        </div>
    </div>
</div>

<div class="site-footer">
    <div class="inner first">
        <div class="container">
            <div class="row">
                <div class="col-md-6 col-lg-4">
                    <div class="widget">
                        <h3 class="heading">About Tour</h3>
                        <p>Far far away, behind the word mountains, far from the countries Vokalia and Consonantia, there live the blind texts.</p>
                    </div>
                    <div class="widget">
                        <ul class="list-unstyled social">
                            <li><a href="#"><span class="icon-twitter"></span></a></li>
                            <li><a href="#"><span class="icon-instagram"></span></a></li>
                            <li><a href="#"><span class="icon-facebook"></span></a></li>
                            <li><a href="#"><span class="icon-linkedin"></span></a></li>
                            <li><a href="#"><span class="icon-dribbble"></span></a></li>
                            <li><a href="#"><span class="icon-pinterest"></span></a></li>
                            <li><a href="#"><span class="icon-apple"></span></a></li>
                            <li><a href="#"><span class="icon-google"></span></a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6 col-lg-2 pl-lg-5">
                    <div class="widget">
                        <h3 class="heading">Pages</h3>
                        <ul class="links list-unstyled">
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6 col-lg-2">
                    <div class="widget">
                        <h3 class="heading">Resources</h3>
                        <ul class="links list-unstyled">
                            <li><a href="#">Blog</a></li>
                            <li><a href="#">About</a></li>
                            <li><a href="#">Contact</a></li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-6 col-lg-4">
                    <div class="widget">
                        <h3 class="heading">Contact</h3>
                        <ul class="list-unstyled quick-info links">
                            <li class="email"><a href="#">mail@example.com</a></li>
                            <li class="phone"><a href="#">+1 222 212 3819</a></li>
                            <li class="address"><a href="#">43 Raymouth Rd. Baltemoer, London 3910</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <div class="inner dark">
        <div class="container">
            <div class="row text-center">
                <div class="col-md-8 mb-3 mb-md-0 mx-auto">
                    <p>Copyright &copy;<script>document.write(new Date().getFullYear());</script>. All Rights Reserved. &mdash; Designed with love by <a href="https://untree.co" class="link-highlight">Untree.co</a> <!-- License information: https://untree.co/license/ -->Distributed By <a href="https://themewagon.com" target="_blank" >ThemeWagon</a>
                    </p>
                </div>

            </div>
        </div>
    </div>
</div>

<div id="overlayer"></div>
<div class="loader">
    <div class="spinner-border" role="status">
        <span class="sr-only">Loading...</span>
    </div>
</div>

<script src="/js/jquery-3.4.1.min.js"></script>
<script src="/js/popper.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/jquery.animateNumber.min.js"></script>
<script src="/js/jquery.waypoints.min.js"></script>
<script src="/js/jquery.fancybox.min.js"></script>
<script src="/js/aos.js"></script>
<script src="/js/moment.min.js"></script>
<script src="/js/daterangepicker.js"></script>

<script src="/js/typed.js"></script>

<script src="/js/custom.js"></script>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=0984e3595a25d0814186af721b2fb03f&libraries=services"></script>
<script>
    var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
            level: 7 // 지도의 확대 레벨
        };
    var map = new kakao.maps.Map(mapContainer, mapOption); // 지도를 생성합니다
    // HTML5의 geolocation으로 사용할 수 있는지 확인합니다
    if (navigator.geolocation) {
        // GeoLocation을 이용해서 접속 위치를 얻어옵니다
        navigator.geolocation.getCurrentPosition(function(position) {
            var lat = position.coords.latitude, // 위도
                lon = position.coords.longitude; // 경도
            var locPosition = new kakao.maps.LatLng(lat, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
                message = '<div style="padding:5px;">사용자 위치</div>'; // 인포윈도우에 표시될 내용입니다
            // 마커와 인포윈도우를 표시합니다
            displayMarker(locPosition, message);
        });
    } else { // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
        var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),
            message = 'geolocation을 사용할수 없어요..'
        displayMarker(locPosition, message);
    }
    // 지도에 마커와 인포윈도우를 표시하는 함수입니다
    function displayMarker(locPosition, message) {
        // 마커를 생성합니다
        var marker = new kakao.maps.Marker({
            map: map,
            position: locPosition
        });
        var iwContent = message, // 인포윈도우에 표시할 내용
            iwRemoveable = true;
        // 인포윈도우를 생성합니다
        var infowindow = new kakao.maps.InfoWindow({
            content: iwContent,
            removable: iwRemoveable
        });
        // 인포윈도우를 마커위에 표시합니다
        infowindow.open(map, marker);
        // 지도 중심좌표를 접속위치로 변경합니다
        map.setCenter(locPosition);
        // 장소 검색 객체를 생성합니다
        var ps = new kakao.maps.services.Places();
        // 키워드로 장소를 검색합니다
        ps.keywordSearch('반려동물장례', placesSearchCB);
    }
    // 키워드 검색 완료 시 호출되는 콜백함수 입니다
    function placesSearchCB(data, status, pagination) {
        if (status === kakao.maps.services.Status.OK) {
            // 사용자 위치를 마커에서 가져옵니다
            const userMarker = map.getCenter();
            const userLat = userMarker.getLat();
            const userLng = userMarker.getLng();

            // 가장 가까운 장소를 찾습니다
            let nearestPlace = null;
            let nearestDistance = Infinity;

            for (let i = 0; i < data.length; i++) {
                const place = data[i];
                const placeLat = place.y;
                const placeLng = place.x;
                const distance = calculateDistance(userLat, userLng, placeLat, placeLng);

                if (distance < nearestDistance) {
                    nearestPlace = place;
                    nearestDistance = distance;
                }
            }

            // <div id="info">에 가장 가까운 장소의 정보를 표시합니다
            if (nearestPlace) {
                const infoDiv = document.getElementById('info');
                infoDiv.innerHTML = `<b>가장 가까운 장례식장 :</b> ${nearestPlace.place_name} (${nearestDistance.toFixed(2)} km)`;

                // 가장 가까운 장소의 마커를 지도에 표시합니다
                const markerPosition = new kakao.maps.LatLng(nearestPlace.y, nearestPlace.x);
                const marker = new kakao.maps.Marker({
                    position: markerPosition,
                    map: map
                });

                // 마커 클릭 시 인포윈도우 표시
                kakao.maps.event.addListener(marker, 'click', function() {
                    const infowindow = new kakao.maps.InfoWindow({
                        content: '<div style="padding:5px;font-size:12px;">' + nearestPlace.place_name + '</div>'
                    });
                    infowindow.open(map, marker);
                });
            }
        }
    }



    // 지도에 마커를 표시하는 함수입니다
    function displayMarker2(place) {
        // 마커를 생성하고 지도에 표시합니다
        var marker2 = new kakao.maps.Marker({
            map: map,
            position: new kakao.maps.LatLng(place.y, place.x)
        });
        // 마커에 클릭이벤트를 등록합니다
        kakao.maps.event.addListener(marker2, 'click', function() {
            // 마커를 클릭하면 장소명이 인포윈도우에 표출됩니다
            var infowindow = new kakao.maps.InfoWindow({
                content: '<div style="padding:5px;font-size:12px;">' + place.place_name + '</div>'
            });
            infowindow.open(map, marker2);
        });
    }



    function calculateDistance(lat1, lon1, lat2, lon2) {
        const R = 6371; // 지구의 반지름 (단위: km)

        const dLat = deg2rad(lat2 - lat1);
        const dLon = deg2rad(lon2 - lon1);
        const a =
            Math.sin(dLat / 2) * Math.sin(dLat / 2) +
            Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) * Math.sin(dLon / 2) * Math.sin(dLon / 2);
        const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
        const distance = R * c; // 거리 (단위: km)

        return distance;
    }

    function deg2rad(deg) {
        return deg * (Math.PI / 180); // 각도를 라디안으로 변환하는 함수
    }

</script>

<script th:inline="javascript">
    function logout() {
        // 로그아웃 요청을 보내는 코드
        fetch('/user/logout', {
            method: 'POST'
        }).then(function(response) {
            // 로그아웃이 성공하면 페이지를 리로드하여 로그아웃 상태를 반영합니다.
            if (response.ok) {
                location.reload();
            }
        }).catch(function(error) {
            console.error('Error during logout:', error);
        });
    }
</script>
</body>

</html>
